define("js/plupload",[],function(){return function(a){return function(){function k(){this.returnValue=!1}function l(){this.cancelBubble=!0}var g,j,a=0,b=[],c={},d={},e={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},f=/[<>&\"\']/g,h=window.setTimeout,i={};(function(a){var c,e,f,b=a.split(/,/);for(c=0;b.length>c;c+=2)for(f=b[c+1].split(/ /),e=0;f.length>e;e++)d[f[e]]=b[c]})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/vnd.rn-realvideo,rv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");var m={VERSION:"@@version@@",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:d,ua:function(){var d,e,f,a=navigator,b=a.userAgent,c=a.vendor;return d=/WebKit/.test(b),f=d&&-1!==c.indexOf("Apple"),e=window.opera&&window.opera.buildNumber,{windows:-1!==navigator.platform.indexOf("Win"),ie:!d&&!e&&/MSIE/gi.test(b)&&/Explorer/gi.test(a.appName),webkit:d,gecko:!d&&/Gecko/.test(b),safari:f,opera:!!e}}(),typeOf:function(a){return{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},extend:function(a){return m.each(arguments,function(b,c){c>0&&m.each(b,function(b,c){a[c]=b})}),a},cleanName:function(a){var b,c;for(c=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],b=0;c.length>b;b+=2)a=a.replace(c[b],c[b+1]);return a=a.replace(/\s+/g,"_"),a=a.replace(/[^a-z0-9_\-\.]+/gi,"")},addRuntime:function(a,c){return c.name=a,b[a]=c,b.push(c),c},guid:function(){var c,b=(new Date).getTime().toString(32);for(c=0;5>c;c++)b+=Math.floor(65535*Math.random()).toString(32);return(m.guidPrefix||"p")+b+(a++).toString(32)},buildUrl:function(a,b){var c="";return m.each(b,function(a,b){c+=(c?"&":"")+encodeURIComponent(b)+"="+encodeURIComponent(a)}),c&&(a+=(a.indexOf("?")>0?"&":"?")+c),a},each:function(a,b){var c,d,e;if(a)if(c=a.length,c===g){for(d in a)if(a.hasOwnProperty(d)&&b(a[d],d)===!1)return}else for(e=0;c>e;e++)if(b(a[e],e)===!1)return},formatSize:function(a){return a===g||/\D/.test(a)?m.translate("N/A"):a>1073741824?Math.round(a/1073741824,1)+" GB":a>1048576?Math.round(a/1048576,1)+" MB":a>1024?Math.round(a/1024,1)+" KB":a+" b"},getPos:function(a,b){function i(a){var b,c,d=0,e=0;return a&&(c=a.getBoundingClientRect(),b="CSS1Compat"===f.compatMode?f.documentElement:f.body,d=c.left+b.scrollLeft,e=c.top+b.scrollTop),{x:d,y:e}}var e,g,h,c=0,d=0,f=document;if(a=a,b=b||f.body,a&&a.getBoundingClientRect&&navigator.userAgent.indexOf("MSIE")>0&&8>f.documentMode)return g=i(a),h=i(b),{x:g.x-h.x,y:g.y-h.y};for(e=a;e&&e!=b&&e.nodeType;)c+=e.offsetLeft||0,d+=e.offsetTop||0,e=e.offsetParent;for(e=a.parentNode;e&&e!=b&&e.nodeType;)c-=e.scrollLeft||0,d-=e.scrollTop||0,e=e.parentNode;return{x:c,y:d}},getSize:function(a){return{w:a.offsetWidth||a.clientWidth,h:a.offsetHeight||a.clientHeight}},parseSize:function(a){var b;return"string"==typeof a&&(a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,"")),b=a[2],a=+a[1],"g"==b&&(a*=1073741824),"m"==b&&(a*=1048576),"k"==b&&(a*=1024)),a},xmlEncode:function(a){return a?(""+a).replace(f,function(a){return e[a]?"&"+e[a]+";":a}):a},toArray:function(a){var b,c=[];for(b=0;a.length>b;b++)c[b]=a[b];return c},inArray:function(a,b){if(b){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(b,a);for(var c=0,d=b.length;d>c;c++)if(b[c]===a)return c}return-1},addI18n:function(a){return m.extend(c,a)},translate:function(a){return c[a]||a},isEmptyObj:function(a){if(a===g)return!0;for(var b in a)return!1;return!0},hasClass:function(a,b){var c;return""==a.className?!1:(c=new RegExp("(^|\\s+)"+b+"(\\s+|$)"),c.test(a.className))},addClass:function(a,b){m.hasClass(a,b)||(a.className=""==a.className?b:a.className.replace(/\s+$/,"")+" "+b)},removeClass:function(a,b){var c=new RegExp("(^|\\s+)"+b+"(\\s+|$)");a.className=a.className.replace(c,function(a,b,c){return" "===b&&" "===c?" ":""})},getStyle:function(a,b){return a.currentStyle?a.currentStyle[b]:window.getComputedStyle?window.getComputedStyle(a,null)[b]:void 0},addEvent:function(a,b,c){var d,e,h;h=arguments[3],b=b.toLowerCase(),j===g&&(j="Plupload_"+m.guid()),a.addEventListener?(d=c,a.addEventListener(b,d,!1)):a.attachEvent&&(d=function(){var a=window.event;a.target||(a.target=a.srcElement),a.preventDefault=k,a.stopPropagation=l,c(a)},a.attachEvent("on"+b,d)),a[j]===g&&(a[j]=m.guid()),i.hasOwnProperty(a[j])||(i[a[j]]={}),e=i[a[j]],e.hasOwnProperty(b)||(e[b]=[]),e[b].push({func:d,orig:c,key:h})},removeEvent:function(a,b){var c,d,e;if("function"==typeof arguments[2]?d=arguments[2]:e=arguments[2],b=b.toLowerCase(),a[j]&&i[a[j]]&&i[a[j]][b]){c=i[a[j]][b];for(var f=c.length-1;f>=0&&(c[f].key!==e&&c[f].orig!==d||(a.removeEventListener?a.removeEventListener(b,c[f].func,!1):a.detachEvent&&a.detachEvent("on"+b,c[f].func),c[f].orig=null,c[f].func=null,c.splice(f,1),d===g));f--);if(c.length||delete i[a[j]][b],m.isEmptyObj(i[a[j]])){delete i[a[j]];try{delete a[j]}catch(h){a[j]=g}}}},removeAllEvents:function(a){var b=arguments[1];a[j]!==g&&a[j]&&m.each(i[a[j]],function(c,d){m.removeEvent(a,d,b)})}};m.Uploader=function(a){function j(){var a,c,b=0;if(this.state==m.STARTED){for(c=0;e.length>c;c++)a||e[c].status!=m.QUEUED?b++:(a=e[c],a.status=m.UPLOADING,this.trigger("BeforeUpload",a)&&this.trigger("UploadFile",a));b==e.length&&(this.stop(),this.trigger("UploadComplete",e))}}function k(){var a,b;for(d.reset(),a=0;e.length>a;a++)b=e[a],b.size!==g?(d.size+=b.size,d.loaded+=b.loaded):d.size=g,b.status==m.DONE?d.uploaded++:b.status==m.FAILED?d.failed++:d.queued++;d.size===g?d.percent=e.length>0?Math.ceil(100*(d.uploaded/e.length)):0:(d.bytesPerSec=Math.ceil(d.loaded/((+new Date-f||1)/1e3)),d.percent=d.size>0?Math.ceil(100*(d.loaded/d.size)):0)}var d,f,c={},e=[],i=!1;d=new m.QueueProgress,a=m.extend({chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",filters:[]},a),m.extend(this,{state:m.STOPPED,runtime:"",features:{},files:e,settings:a,total:d,id:m.guid(),init:function(){
function p(){var b,d,e,a=i[n++];if(a){if(b=a.getFeatures(),d=c.settings.required_features)for(d=d.split(","),e=0;d.length>e;e++)if(!b[d[e]])return p(),void 0;a.init(c,function(d){d&&d.success?(c.features=b,c.runtime=a.name,c.trigger("Init",{runtime:a.name}),c.trigger("PostInit"),c.refresh()):p()})}else c.trigger("Error",{code:m.INIT_ERROR,message:m.translate("Init error.")})}var d,i,o,c=this,n=0;if("function"==typeof a.preinit?a.preinit(c):m.each(a.preinit,function(a,b){c.bind(b,a)}),a.page_url=a.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/"),/^(\w+:\/\/|\/)/.test(a.url)||(a.url=a.page_url+a.url),a.chunk_size=m.parseSize(a.chunk_size),a.max_file_size=m.parseSize(a.max_file_size),c.bind("FilesAdded",function(b,d){var f,i,k,j=0,l=a.filters;for(l&&l.length&&(k=[],m.each(l,function(a){m.each(a.extensions.split(/,/),function(a){/^\s*\*\s*$/.test(a)?k.push("\\.*"):k.push("\\."+a.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),k=new RegExp(k.join("|")+"$","i")),f=0;d.length>f;f++)i=d[f],i.loaded=0,i.percent=0,i.status=m.QUEUED,!k||k.test(i.name)?i.size!==g&&i.size>a.max_file_size?b.trigger("Error",{code:m.FILE_SIZE_ERROR,message:m.translate("File size error."),file:i}):(e.push(i),j++):b.trigger("Error",{code:m.FILE_EXTENSION_ERROR,message:m.translate("File extension error."),file:i});return j?(h(function(){c.trigger("QueueChanged"),c.refresh()},1),void 0):!1}),a.unique_names&&c.bind("UploadFile",function(a,b){var c=b.name.match(/\.([^.]+)$/),d="tmp";c&&(d=c[1]),b.target_name=b.id+"."+d}),c.bind("UploadProgress",function(a,b){b.percent=b.size>0?Math.ceil(100*(b.loaded/b.size)):100,k()}),c.bind("StateChanged",function(a){if(a.state==m.STARTED)f=+new Date;else if(a.state==m.STOPPED)for(d=a.files.length-1;d>=0;d--)a.files[d].status==m.UPLOADING&&(a.files[d].status=m.QUEUED,k())}),c.bind("QueueChanged",k),c.bind("Error",function(a,b){b.file&&(b.file.status=m.FAILED,k(),a.state==m.STARTED&&h(function(){j.call(c)},1))}),c.bind("FileUploaded",function(a,b){b.status=m.DONE,b.loaded=b.size,a.trigger("UploadProgress",b),h(function(){j.call(c)},1)}),a.runtimes)for(i=[],o=a.runtimes.split(/\s?,\s?/),d=0;o.length>d;d++)b[o[d]]&&i.push(b[o[d]]);else i=b;p(),"function"==typeof a.init?a.init(c):m.each(a.init,function(a,b){c.bind(b,a)})},refresh:function(){this.trigger("Refresh")},start:function(){e.length&&this.state!=m.STARTED&&(this.state=m.STARTED,this.trigger("StateChanged"),j.call(this))},stop:function(){this.state!=m.STOPPED&&(this.state=m.STOPPED,this.trigger("CancelUpload"),this.trigger("StateChanged"))},disableBrowse:function(){i=arguments[0]!==g?arguments[0]:!0,this.trigger("DisableBrowse",i)},getFile:function(a){var b;for(b=e.length-1;b>=0;b--)if(e[b].id===a)return e[b]},removeFile:function(a){var b;for(b=e.length-1;b>=0;b--)if(e[b].id===a.id)return this.splice(b,1)[0]},splice:function(a,b){var c;return c=e.splice(a===g?0:a,b===g?e.length:b),this.trigger("FilesRemoved",c),this.trigger("QueueChanged"),c},trigger:function(a){var d,e,b=c[a.toLowerCase()];if(b)for(e=Array.prototype.slice.call(arguments),e[0]=this,d=0;b.length>d;d++)if(b[d].func.apply(b[d].scope,e)===!1)return!1;return!0},hasEventListener:function(a){return!!c[a.toLowerCase()]},bind:function(a,b,d){var e;a=a.toLowerCase(),e=c[a]||[],e.push({func:b,scope:d||this}),c[a]=e},unbind:function(a){a=a.toLowerCase();var d,b=c[a],e=arguments[1];if(b){if(e!==g){for(d=b.length-1;d>=0;d--)if(b[d].func===e){b.splice(d,1);break}}else b=[];b.length||delete c[a]}},unbindAll:function(){var a=this;m.each(c,function(b,c){a.unbind(c)})},destroy:function(){this.stop(),this.trigger("Destroy"),this.unbindAll()}})},m.File=function(a,b,c){var d=this;d.id=a,d.name=b,d.size=c,d.loaded=0,d.percent=0,d.status=0,d.fullpath=""},m.Runtime=function(){this.getFeatures=function(){},this.init=function(){}},m.QueueProgress=function(){var a=this;a.size=0,a.loaded=0,a.uploaded=0,a.failed=0,a.queued=0,a.percent=0,a.bytesPerSec=0,a.reset=function(){a.size=a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}},m.runtimes={},window.plupload=m}(),function(a,b,c){function g(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(b){try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(c){a="0.0"}}return a=a.match(/\d+/g),parseFloat(a[0]+"."+a[1])}var e={},f={};c.flash={trigger:function(a,b,c){setTimeout(function(){var d=e[a];d&&d.trigger("Flash:"+b,c)},0)}},c.runtimes.Flash=c.addRuntime("flash",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,maxWidth:8091,maxHeight:8091,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(a,d){function l(){return b.getElementById(a.id+"_flash")}function m(){return j++>5e3?(d({success:!1}),void 0):(f[a.id]===!1&&setTimeout(m,1),void 0)}var h,i,j=0,k=b.body;return 10>g()?(d({success:!1}),void 0):(f[a.id]=!1,e[a.id]=a,h=b.getElementById(a.settings.browse_button),i=b.createElement("div"),i.id=a.id+"_flash_container",c.extend(i.style,{position:"absolute",top:"0px",background:a.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"}),i.className="plupload flash",a.settings.container&&(k=b.getElementById(a.settings.container),"static"===c.getStyle(k,"position")&&(k.style.position="relative")),k.appendChild(i),function(){var d,e;d='<object id="'+a.id+'_flash" type="application/x-shockwave-flash" data="'+a.settings.flash_swf_url+'" ',c.ua.ie&&(d+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),d+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+a.settings.flash_swf_url+'" /><param name="flashvars" value="id='+escape(a.id)+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',c.ua.ie?(e=b.createElement("div"),i.appendChild(e),e.outerHTML=d,e=null):i.innerHTML=d}(),m(),h=i=null,a.bind("Destroy",function(a){var d;c.removeAllEvents(b.body,a.id),delete f[a.id],delete e[a.id],d=b.getElementById(a.id+"_flash_container"),d&&k.removeChild(d)}),a.bind("Flash:Init",function(){var e={};try{l().setFileFilters(a.settings.filters,a.settings.multi_selection)}catch(h){return d({success:!1}),void 0}f[a.id]||(f[a.id]=!0,a.bind("UploadFile",function(b,d){var f=b.settings,g=a.settings.resize||{};l().uploadFile(e[d.id],f.url,{name:d.target_name||d.name,mime:c.mimeTypes[d.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:f.chunk_size,width:g.width,height:g.height,quality:g.quality,multipart:f.multipart,multipart_params:f.multipart_params||{},file_data_name:f.file_data_name,format:/\.(jpg|jpeg)$/i.test(d.name)?"jpg":"png",headers:f.headers,urlstream_upload:f.urlstream_upload})}),a.bind("CancelUpload",function(){l().cancelUpload()}),a.bind("Flash:UploadProcess",function(a,b){var d=a.getFile(e[b.id]);d.status!=c.FAILED&&(d.loaded=b.loaded,d.size=b.size,a.trigger("UploadProgress",d))}),a.bind("Flash:UploadChunkComplete",function(a,b){var d,f=a.getFile(e[b.id]);d={chunk:b.chunk,chunks:b.chunks,response:b.text},a.trigger("ChunkUploaded",f,d),f.status!==c.FAILED&&a.state!==c.STOPPED&&l().uploadNextChunk(),b.chunk==b.chunks-1&&(f.status=c.DONE,a.trigger("FileUploaded",f,{response:b.text}))}),a.bind("Flash:SelectFiles",function(b,d){var f,g,i,h=[];for(g=0;d.length>g;g++)f=d[g],i=c.guid(),e[i]=f.id,e[f.id]=i,h.push(new c.File(i,f.name,f.size));h.length&&a.trigger("FilesAdded",h)}),a.bind("Flash:SecurityError",function(b,d){a.trigger("Error",{
code:c.SECURITY_ERROR,message:c.translate("Security error."),details:d.message,file:a.getFile(e[d.id])})}),a.bind("Flash:GenericError",function(b,d){a.trigger("Error",{code:c.GENERIC_ERROR,message:c.translate("Generic error."),details:d.message,file:a.getFile(e[d.id])})}),a.bind("Flash:IOError",function(b,d){a.trigger("Error",{code:c.IO_ERROR,message:c.translate("IO error."),details:d.message,file:a.getFile(e[d.id])})}),a.bind("Flash:ImageError",function(b,d){a.trigger("Error",{code:parseInt(d.code,10),message:c.translate("Image error."),file:a.getFile(e[d.id])})}),a.bind("Flash:StageEvent:rollOver",function(d){var e,f;e=b.getElementById(a.settings.browse_button),f=d.settings.browse_button_hover,e&&f&&c.addClass(e,f)}),a.bind("Flash:StageEvent:rollOut",function(d){var e,f;e=b.getElementById(a.settings.browse_button),f=d.settings.browse_button_hover,e&&f&&c.removeClass(e,f)}),a.bind("Flash:StageEvent:mouseDown",function(d){var e,f;e=b.getElementById(a.settings.browse_button),f=d.settings.browse_button_active,e&&f&&(c.addClass(e,f),c.addEvent(b.body,"mouseup",function(){c.removeClass(e,f)},d.id))}),a.bind("Flash:StageEvent:mouseUp",function(d){var e,f;e=b.getElementById(a.settings.browse_button),f=d.settings.browse_button_active,e&&f&&c.removeClass(e,f)}),a.bind("Flash:ExifData",function(b,c){a.trigger("ExifData",a.getFile(e[c.id]),c.data)}),a.bind("Flash:GpsData",function(b,c){a.trigger("GpsData",a.getFile(e[c.id]),c.data)}),a.bind("QueueChanged",function(){a.refresh()}),a.bind("FilesRemoved",function(a,b){var c;for(c=0;b.length>c;c++)l().removeFile(e[b[c].id])}),a.bind("StateChanged",function(){a.refresh()}),a.bind("Refresh",function(d){var e,f,g;l().setFileFilters(a.settings.filters,a.settings.multi_selection),e=b.getElementById(d.settings.browse_button),e&&(f=c.getPos(e,b.getElementById(d.settings.container)),g=c.getSize(e),c.extend(b.getElementById(d.id+"_flash_container").style,{top:f.y+"px",left:f.x+"px",width:g.w+"px",height:g.h+"px"}))}),a.bind("DisableBrowse",function(a,b){l().disableBrowse(b)}),d({success:!0}))}),void 0)}})}(window,document,plupload),function(a){a.runtimes.BrowserPlus=a.addRuntime("browserplus",{getFeatures:function(){return{dragdrop:!0,jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(b,c){function h(c){var f,h,i,g=[];for(f=0;c.length>f;f++)h=c[f],i=a.guid(),e[i]=h,g.push(new a.File(i,h.name,h.size));f&&b.trigger("FilesAdded",g)}function i(){var i=!1;b.bind("PostInit",function(){function l(a,b){d.DragAndDrop.AddDropTarget({id:a},function(){d.DragAndDrop.AttachCallbacks({id:a,hover:function(a){!a&&b&&b()},drop:function(a){b&&b(),h(a)}},function(){})})}function m(){document.getElementById(g).style.top="-1000px"}var c,e=f.drop_element,g=b.id+"_droptarget",j=document.getElementById(e);j&&(document.attachEvent&&/MSIE/gi.test(navigator.userAgent)?(c=document.createElement("div"),c.setAttribute("id",g),a.extend(c.style,{position:"absolute",top:"-1000px",background:"red",filter:"alpha(opacity=0)",opacity:0}),document.body.appendChild(c),a.addEvent(j,"dragenter",function(){var c,d;c=document.getElementById(e),d=a.getPos(c),a.extend(document.getElementById(g).style,{top:d.y+"px",left:d.x+"px",width:c.offsetWidth+"px",height:c.offsetHeight+"px"})}),l(g,m)):l(e)),a.addEvent(document.getElementById(f.browse_button),"click",function(b){var e,g,k,l,c=[],j=f.filters;if(b.preventDefault(),!i){a:for(e=0;j.length>e;e++)for(k=j[e].extensions.split(","),g=0;k.length>g;g++){if("*"===k[g]){c=[];break a}l=a.mimeTypes[k[g]],l&&-1===a.inArray(l,c)&&c.push(a.mimeTypes[k[g]])}d.FileBrowse.OpenBrowseDialog({mimeTypes:c},function(a){a.success&&h(a.value)})}}),j=c=null}),b.bind("CancelUpload",function(){d.Uploader.cancel({},function(){})}),b.bind("DisableBrowse",function(a,b){i=b}),b.bind("UploadFile",function(b,c){function l(e,f){var g;c.status!=a.FAILED&&(h.name=c.target_name||c.name,i&&(h.chunk=""+e,h.chunks=""+f),g=k.shift(),d.Uploader.upload({url:b.settings.url,files:{file:g},cookies:document.cookies,postvars:a.extend(h,b.settings.multipart_params),progressCallback:function(a){var d,f=0;for(j[e]=parseInt(a.filePercent*g.size/100,10),d=0;j.length>d;d++)f+=j[d];c.loaded=f,b.trigger("UploadProgress",c)}},function(d){var g;d.success?(g=d.value.statusCode,i&&b.trigger("ChunkUploaded",c,{chunk:e,chunks:f,response:d.value.body,status:g}),k.length>0?l(++e,f):(c.status=a.DONE,b.trigger("FileUploaded",c,{response:d.value.body,status:g}),g>=400&&b.trigger("Error",{code:a.HTTP_ERROR,message:a.translate("HTTP Error."),file:c,status:g}))):b.trigger("Error",{code:a.GENERIC_ERROR,message:a.translate("Generic Error."),file:c,details:d.error})}))}function m(a){c.size=a.size,i?d.FileAccess.chunk({file:a,chunkSize:i},function(a){if(a.success){var b=a.value,c=b.length;j=Array(c);for(var d=0;c>d;d++)j[d]=0,k.push(b[d]);l(0,c)}}):(j=Array(1),k.push(a),l(0,1))}var j,f=e[c.id],h={},i=b.settings.chunk_size,k=[];g&&/\.(png|jpg|jpeg)$/i.test(c.name)?BrowserPlus.ImageAlter.transform({file:f,quality:g.quality||90,actions:[{scale:{maxwidth:g.width,maxheight:g.height}}]},function(a){a.success&&m(a.value.file)}):m(f)}),c({success:!0})}var d=window.BrowserPlus,e={},f=b.settings,g=f.resize;d?d.init(function(a){var b=[{service:"Uploader",version:"3"},{service:"DragAndDrop",version:"1"},{service:"FileBrowse",version:"1"},{service:"FileAccess",version:"2"}];g&&b.push({service:"ImageAlter",version:"4"}),a.success?d.require({services:b},function(a){a.success?i():c()}):c()}):c()}})}(plupload),function(a,b,c){function e(a){return b.getElementById(a)}c.runtimes.Html4=c.addRuntime("html4",{getFeatures:function(){return{multipart:!0,triggerDialog:c.ua.gecko&&a.FormData||c.ua.webkit}},init:function(d,f){d.bind("Init",function(f){function u(){var a,h,i,j;l=c.guid(),m.push(l),a=b.createElement("form"),a.setAttribute("id","form_"+l),a.setAttribute("method","post"),a.setAttribute("enctype","multipart/form-data"),a.setAttribute("encoding","multipart/form-data"),a.setAttribute("target",f.id+"_iframe"),a.style.position="absolute",h=b.createElement("input"),h.setAttribute("id","input_"+l),h.setAttribute("type","file"),h.setAttribute("accept",o),h.setAttribute("size",1),j=e(f.settings.browse_button),f.features.triggerDialog&&j&&c.addEvent(e(f.settings.browse_button),"click",function(a){h.disabled||h.click(),a.preventDefault()},f.id),c.extend(h.style,{width:"100%",height:"100%",opacity:0,fontSize:"99px",cursor:"pointer"}),c.extend(a.style,{overflow:"hidden"}),i=f.settings.shim_bgcolor,i&&(a.style.background=i),n&&c.extend(h.style,{filter:"alpha(opacity=0)"}),c.addEvent(h,"change",function(b){var i,g=b.target,k=[];if(g.value){e("form_"+l).style.top="-1048575px",i=g.value.replace(/\\/g,"/");var n=i;i=i.substring(i.length,i.lastIndexOf("/")+1);var o=new c.File(l,i);o.fullpath=n,k.push(o),f.features.triggerDialog?c.removeEvent(j,"click",f.id):c.removeAllEvents(a,f.id),c.removeEvent(h,"change",f.id),u(),k.length&&d.trigger("FilesAdded",k)}},f.id),a.appendChild(h),g.appendChild(a),f.refresh()}function w(){var d=b.createElement("div");d.innerHTML='<iframe id="'+f.id+'_iframe" name="'+f.id+'_iframe" src="'+i+':&quot;&quot;" style="display:none"></iframe>',h=d.firstChild,g.appendChild(h),c.addEvent(h,"load",function(b){var e,g,d=b.target;if(j){try{e=d.contentWindow.document||d.contentDocument||a.frames[d.id].document}catch(h){return f.trigger("Error",{code:c.SECURITY_ERROR,message:c.translate("Security error."),file:j}),void 0}g=e.body.innerHTML,g&&(j.status=c.DONE,j.loaded=1025,j.percent=100,
f.trigger("UploadProgress",j),f.trigger("FileUploaded",j,{response:g}))}},f.id)}var h,j,l,q,r,s,t,g=b.body,i="javascript",m=[],n=/MSIE/.test(navigator.userAgent),o=[],p=f.settings.filters;a:for(q=0;p.length>q;q++)for(r=p[q].extensions.split(/,/),t=0;r.length>t;t++){if("*"===r[t]){o=[];break a}s=c.mimeTypes[r[t]],s&&-1===c.inArray(s,o)&&o.push(s)}o=o.join(","),f.settings.container&&(g=e(f.settings.container),"static"===c.getStyle(g,"position")&&(g.style.position="relative")),f.bind("UploadFile",function(a,d){var f,g;d.status!=c.DONE&&d.status!=c.FAILED&&a.state!=c.STOPPED&&(f=e("form_"+d.id),g=e("input_"+d.id),g.setAttribute("name",a.settings.file_data_name),f.setAttribute("action",a.settings.url),c.each(c.extend({name:d.target_name||d.name},a.settings.multipart_params),function(a,d){var e=b.createElement("input");c.extend(e,{type:"hidden",name:d,value:a}),f.insertBefore(e,f.firstChild)}),j=d,e("form_"+l).style.top="-1048575px",f.submit())}),f.bind("FileUploaded",function(a){a.refresh()}),f.bind("StateChanged",function(b){b.state==c.STARTED?w():b.state==c.STOPPED&&a.setTimeout(function(){c.removeEvent(h,"load",b.id),h.parentNode&&h.parentNode.removeChild(h)},0),c.each(b.files,function(a){if(a.status===c.DONE||a.status===c.FAILED){var d=e("form_"+a.id);d&&d.parentNode.removeChild(d)}})}),f.bind("Refresh",function(a){var d,f,g,h,i,j,k,m,n;d=e(a.settings.browse_button),d&&(i=c.getPos(d,e(a.settings.container)),j=c.getSize(d),k=e("form_"+l),m=e("input_"+l),c.extend(k.style,{top:i.y+"px",left:i.x+"px",width:j.w+"px",height:j.h+"px"}),a.features.triggerDialog&&("static"===c.getStyle(d,"position")&&c.extend(d.style,{position:"relative"}),n=parseInt(d.style.zIndex,10),isNaN(n)&&(n=0),c.extend(d.style,{zIndex:n}),c.extend(k.style,{zIndex:n-1})),g=a.settings.browse_button_hover,h=a.settings.browse_button_active,f=a.features.triggerDialog?d:k,g&&(c.addEvent(f,"mouseover",function(){c.addClass(d,g)},a.id),c.addEvent(f,"mouseout",function(){c.removeClass(d,g)},a.id)),h&&(c.addEvent(f,"mousedown",function(){c.addClass(d,h)},a.id),c.addEvent(b.body,"mouseup",function(){c.removeClass(d,h)},a.id)))}),d.bind("FilesRemoved",function(a,b){var c,d;for(c=0;b.length>c;c++)d=e("form_"+b[c].id),d&&d.parentNode.removeChild(d)}),d.bind("DisableBrowse",function(a,c){var d=b.getElementById("input_"+l);d&&(d.disabled=c)}),d.bind("Destroy",function(a){var d,f,h,i={inputContainer:"form_"+l,inputFile:"input_"+l,browseButton:a.settings.browse_button};for(d in i)f=e(i[d]),f&&c.removeAllEvents(f,a.id);c.removeAllEvents(b.body,a.id),c.each(m,function(a){h=e("form_"+a),h&&g.removeChild(h)})}),u()}),f({success:!0})}})}(window,document,plupload),plupload.addI18n({"Select files":"选择文件","Add files to the upload queue and click the start button.":"添加文件到上传队列，然后点击开始上传按钮。",Filename:"文件名",Status:"状态",Size:"大小","Add Files":"添加文件","Stop Upload":"停止上传","Start Upload":"开始上传","Add files":"添加文件","Add files.":"添加文件。","Stop current upload":"停止当前上传","Start uploading queue":"开始上传队列","Stop upload":"停止上传","Start upload":"开始上传","Uploaded %d/%d files":"已经上传 %d/%d 个文件","N/A":"N/A","Drag files here.":"拖动文件到这里","File extension error.":"文件扩展名错误","File size error.":"文件大小错误","File count error.":"文件数量错误","Init error.":"初始化错误","HTTP Error.":"HTTP 错误","Security error.":"安全错误","Generic error.":"常见错误","IO error.":"IO错误","File: %s":"文件百分比 : %s",Close:"关闭","%d files queued":"%d 个队列中","Using runtime: ":"使用运行时: ","File: %f, size: %s, max file size: %m":"文件名: %f, 大小: %s, 文件最大值: %m","Upload element accepts only %d file(s) at a time. Extra files were stripped.":"上传文件只接受%d，其他的文件被忽略","Upload URL might be wrong or doesn't exist":"上传文件有错误或者文件不存在","Error: File too large: ":"错误：文件太大: ","Error: Invalid file extension: ":"错误：禁止的文件扩展名: "}),a.noConflict(!0)}}),define("js/jquery.plupload.queue",["./plupload","../../theme/default/css/jquery.plupload.queue.css"],function(a){return function(b){var b=a("./plupload")(b);return a("../theme/default/css/jquery.plupload.queue.css"),function(a){function c(a){return plupload.translate(a)||a}function d(b,d){d.contents().each(function(b,c){c=a(c),c.is(".plupload")||c.remove()}),d.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+b+'_container" class="plupload_container">'+'<div class="plupload">'+'<div class="plupload_header">'+'<div class="plupload_header_content">'+'<div class="plupload_header_title">'+c("Select files")+"</div>"+'<div class="plupload_header_text">'+c("Add files to the upload queue and click the start button.")+"</div>"+"</div>"+"</div>"+'<div class="plupload_content">'+'<div class="plupload_filelist_header">'+'<div class="plupload_file_name">'+c("Filename")+"</div>"+'<div class="plupload_file_action">&nbsp;</div>'+'<div class="plupload_file_status"><span>'+c("Status")+"</span></div>"+'<div class="plupload_file_size">'+c("Size")+"</div>"+'<div class="plupload_clearer">&nbsp;</div>'+"</div>"+'<ul id="'+b+'_filelist" class="plupload_filelist"></ul>'+'<div class="plupload_filelist_footer">'+'<div class="plupload_file_name">'+'<div class="plupload_buttons">'+'<a href="#" class="plupload_button plupload_add">'+c("Add files")+"</a>"+'<a href="#" class="plupload_button plupload_start">'+c("Start upload")+"</a>"+"</div>"+'<span class="plupload_upload_status"></span>'+"</div>"+'<div class="plupload_file_action"></div>'+'<div class="plupload_file_status"><span class="plupload_total_status">0%</span></div>'+'<div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div>'+'<div class="plupload_progress">'+'<div class="plupload_progress_container">'+'<div class="plupload_progress_bar"></div>'+"</div>"+"</div>"+'<div class="plupload_clearer">&nbsp;</div>'+"</div>"+"</div>"+"</div>"+"</div>"+'<input type="hidden" id="'+b+'_count" name="'+b+'_count" value="0" />'+"</div>")}var b={};a.fn.pluploadQueue=function(e){return e?(this.each(function(){function i(b){var c;b.status==plupload.DONE&&(c="plupload_done"),b.status==plupload.FAILED&&(c="plupload_failed"),b.status==plupload.QUEUED&&(c="plupload_delete"),b.status==plupload.UPLOADING&&(c="plupload_uploading");var d=a("#"+b.id).attr("class",c).find("a").css("display","block");b.hint&&d.attr("title",b.hint)}function j(){a("span.plupload_total_status",g).html(f.total.percent+"%"),a("div.plupload_progress_bar",g).css("width",f.total.percent+"%"),a("span.plupload_upload_status",g).text(c("Uploaded %d/%d files").replace(/%d\/%d/,f.total.uploaded+"/"+f.files.length))}function k(){var e,b=a("ul.plupload_filelist",g).html(""),d=0;a.each(f.files,function(c,g){e="",g.status==plupload.DONE&&(g.target_name&&(e+='<input type="hidden" name="'+h+"_"+d+'_tmpname" value="'+plupload.xmlEncode(g.target_name)+'" />'),e+='<input type="hidden" name="'+h+"_"+d+'_name" value="'+plupload.xmlEncode(g.name)+'" />',e+='<input type="hidden" name="'+h+"_"+d+'_status" value="'+(g.status==plupload.DONE?"done":"failed")+'" />',d++,a("#"+h+"_count").val(d)),b.append('<li id="'+g.id+'">'+'<div class="plupload_file_name"><span>'+g.name+"</span></div>"+'<div class="plupload_file_action"><a href="#"></a></div>'+'<div class="plupload_file_status">'+g.percent+"%</div>"+'<div class="plupload_file_size">'+plupload.formatSize(g.size)+"</div>"+'<div class="plupload_clearer">&nbsp;</div>'+e+"</li>"),i(g),a("#"+g.id+".plupload_delete a").click(function(b){a("#"+g.id).remove(),f.removeFile(g),b.preventDefault()})}),a("span.plupload_total_file_size",g).html(plupload.formatSize(f.total.size)),
0===f.total.queued?a("span.plupload_add_text",g).text(c("Add files.")):a("span.plupload_add_text",g).text(f.total.queued+" files queued."),a("a.plupload_start",g).toggleClass("plupload_disabled",f.files.length==f.total.uploaded+f.total.failed),b[0].scrollTop=b[0].scrollHeight,j(),!f.files.length&&f.features.dragdrop&&f.settings.dragdrop&&a("#"+h+"_filelist").append('<li class="plupload_droptext">'+c("Drag files here.")+"</li>")}var f,g,h;g=a(this),h=g.attr("id"),h||(h=plupload.guid(),g.attr("id",h)),f=new plupload.Uploader(a.extend({dragdrop:!0,container:h},e)),b[h]=f,f.bind("UploadFile",function(b,c){a("#"+c.id).addClass("plupload_current_file")}),f.bind("Init",function(b,i){d(h,g),!e.unique_names&&e.rename&&a("#"+h+"_filelist div.plupload_file_name span",g).live("click",function(c){var e,f,g,d=a(c.target),h="";e=b.getFile(d.parents("li")[0].id),g=e.name,f=/^(.+)(\.[^.]+)$/.exec(g),f&&(g=f[1],h=f[2]),d.hide().after('<input type="text" />'),d.next().val(g).focus().blur(function(){d.show().next().remove()}).keydown(function(b){var c=a(this);13==b.keyCode&&(b.preventDefault(),e.name=c.val()+h,d.text(e.name),c.blur())})}),a("a.plupload_add",g).attr("id",h+"_browse"),b.settings.browse_button=h+"_browse",b.features.dragdrop&&b.settings.dragdrop&&(b.settings.drop_element=h+"_filelist",a("#"+h+"_filelist").append('<li class="plupload_droptext">'+c("Drag files here.")+"</li>")),a("#"+h+"_container").attr("title","Using runtime: "+i.runtime),a("a.plupload_start",g).click(function(b){a(this).hasClass("plupload_disabled")||f.start(),b.preventDefault()}),a("a.plupload_stop",g).click(function(a){a.preventDefault(),f.stop()}),a("a.plupload_start",g).addClass("plupload_disabled")}),f.init(),f.bind("Error",function(b,d){var f,e=d.file;e&&(f=d.message,d.details&&(f+=" ("+d.details+")"),d.code==plupload.FILE_SIZE_ERROR&&alert(c("Error: File too large: ")+e.name),d.code==plupload.FILE_EXTENSION_ERROR&&alert(c("Error: Invalid file extension: ")+e.name),e.hint=f,a("#"+e.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",f))}),f.bind("StateChanged",function(){f.state===plupload.STARTED?(a("li.plupload_delete a,div.plupload_buttons",g).hide(),a("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",g).css("display","block"),a("span.plupload_upload_status",g).text("Uploaded "+f.total.uploaded+"/"+f.files.length+" files"),e.multiple_queues&&a("span.plupload_total_status,span.plupload_total_file_size",g).show()):(k(),a("a.plupload_stop,div.plupload_progress",g).hide(),a("a.plupload_delete",g).css("display","block"))
}),f.bind("QueueChanged",k),f.bind("FileUploaded",function(a,b){i(b)}),f.bind("UploadProgress",function(b,c){a("#"+c.id+" div.plupload_file_status",g).html(c.percent+"%"),i(c),j(),e.multiple_queues&&f.total.uploaded+f.total.failed==f.files.length&&(a(".plupload_buttons,.plupload_upload_status",g).css("display","inline"),a(".plupload_start",g).addClass("plupload_disabled"),a("span.plupload_total_status,span.plupload_total_file_size",g).hide())}),e.setup&&e.setup(f)}),this):b[a(this[0]).attr("id")]}}(b),b.noConflict(!0)}});